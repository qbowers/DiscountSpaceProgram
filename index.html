<!doctype HTML>
<html>
    <head>
        <title>DSP || Pelican Lord</title>
        
        <!-- Bootstrap references -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <!-- Bootstrap references -->
        
        <link rel='stylesheet' href='css/style.css'>
        
    </head>
    <body>
        
        <!--<div class='panel panel-default' id='statLog'>
            <div class='panel-body'>
                <p id='z_rot'></p>
                <p id='y_rot'></p>
            </div>
        </div>-->
        
        
    </body>
    
    <!-- LIB REFERENCES -->
    <script src='/socket.io/socket.io.js'></script>
    <script src='js/libs/three.min.js'></script>
    <!--<script src='js/libs/stl_loader.js'></script>
    <!-- LIB REFERENCES -->
    
    
    
    <script src='js/client-script.js'></script>
    <script>
        
        var socket = io();
        
        var hist = false;
        
        socket.on('connect', function(){
            localId = '/#' + socket.id;
            console.log('local id: ' + localId);
            
            if (hist === false) {
                socket.emit('hist', hist);
                hist = true;
            }
            
            
        });
        
        socket.on('START', function(){
            view.focus = bodies[0].mesh;
            camUpdate();
            CREATE();
            render();
        });
        
        
        socket.on('world', function(c_bodies){
            for (var i = 0; i < c_bodies.length; i++) {
                bodies[i] = {
                    name: c_bodies.name,
                    orbit: c_bodies.orbit,
                    geometry: eval(c_bodies[i].geometry),
                    material: eval(c_bodies[i].material)
                };
                
                bodies[i].mesh = new THREE.Mesh(bodies[i].geometry, bodies[i].material);
                
                scene.add(bodies[i].mesh);
                
                p_set(bodies[i].mesh, c_bodies[i].position);         r_set(bodies[i].mesh, c_bodies[i].position);

            };
        });
        
        /*
        socket.on('addPlayer', function(data){
            var id = data.id,
                geometry = eval(data.player.geometry),
                material = eval(data.player.material),
                newPlayer = {
                    mesh: new THREE.Mesh(geometry, material),
                    nickName: data.player.nickname
                };
            
            console.log('connected: ' + id);
            
            players[id] = newPlayer;
            
            positionSet(players[id].mesh, data.player);
            rotationSet(players[id].mesh, data.player);
            
            scene.add(players[id].mesh);
        });
        
        
        socket.on('updateData', function(data){
            positionSet(players[data.id].mesh, data.player);
            //rotationSet(players[data.id].mesh, data.player);
            players[data.id].mesh.rotation.x = data.player.rotation.x;
            players[data.id].mesh.rotation.y = data.player.rotation.y;
            players[data.id].mesh.rotation.z = data.player.rotation.z;
        });
        
        socket.on('removePlayer', function(data){
            var id = data;
            console.log('disconnected: ' + id);
            scene.remove(players[id].mesh);
            delete players[id];
        });
        */
    </script>
</html>